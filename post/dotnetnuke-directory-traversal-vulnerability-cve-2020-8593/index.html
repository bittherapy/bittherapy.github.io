<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Adrian">
<meta name="description"
    content="CVE: CVE-2020-8593
Vendor: DNN Software (https://www.dnnsoftware.com/, https://dnncommunity.org/)
Product: DotNetNuke, DNN Platform
Version Affected: &amp;lt;= 9.4.x
Fixed Version: 9.5.0
Description:
 &amp;ldquo;The DNN Platform is a free and open source product you can download today and create powerful websites with.&amp;rdquo;
 The DNN Platform&amp;rsquo;s administrative panel provides a File Manager component which is vulnerable to directory traversal. Attackers can upload a specially crafted zip file which when extracted, allows navigation outside of the File Manager defined Root." />
<meta name="keywords" content="security,research,vulnerabilities,cve,malware,reverse engineering,malware analysis,blog,consulting,cyber" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/post/dotnetnuke-directory-traversal-vulnerability-cve-2020-8593/" />


<title>
    
    DotNetNuke Directory Traversal Vulnerability (CVE-2020-8593) :: { bit.therapy } 
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="DotNetNuke Directory Traversal Vulnerability (CVE-2020-8593)">
<meta itemprop="description" content="CVE: CVE-2020-8593
Vendor: DNN Software (https://www.dnnsoftware.com/, https://dnncommunity.org/)
Product: DotNetNuke, DNN Platform
Version Affected: &lt;= 9.4.x
Fixed Version: 9.5.0
Description:
 &ldquo;The DNN Platform is a free and open source product you can download today and create powerful websites with.&rdquo;
 The DNN Platform&rsquo;s administrative panel provides a File Manager component which is vulnerable to directory traversal. Attackers can upload a specially crafted zip file which when extracted, allows navigation outside of the File Manager defined Root.">


<meta itemprop="datePublished" content="2020-04-08T00:00:00-04:00" />
<meta itemprop="dateModified" content="2020-04-08T00:00:00-04:00" />
<meta itemprop="wordCount" content="356">



<meta itemprop="keywords" content="security research,application security,disclosure,directory traversal,path traversal,cve,security,CVE-2020-8593," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="DotNetNuke Directory Traversal Vulnerability (CVE-2020-8593)"/>
<meta name="twitter:description" content="CVE: CVE-2020-8593
Vendor: DNN Software (https://www.dnnsoftware.com/, https://dnncommunity.org/)
Product: DotNetNuke, DNN Platform
Version Affected: &lt;= 9.4.x
Fixed Version: 9.5.0
Description:
 &ldquo;The DNN Platform is a free and open source product you can download today and create powerful websites with.&rdquo;
 The DNN Platform&rsquo;s administrative panel provides a File Manager component which is vulnerable to directory traversal. Attackers can upload a specially crafted zip file which when extracted, allows navigation outside of the File Manager defined Root."/>




<meta property="article:published_time" content="2020-04-08 00:00:00 -0400 EDT" />







    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">{ bit.therapy }</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/post">Blog</a></li><li><a href="/research">Research</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/post/dotnetnuke-directory-traversal-vulnerability-cve-2020-8593/">DotNetNuke Directory Traversal Vulnerability (CVE-2020-8593)</a></h2>

            

            <div class="post-content">
                

<p><strong>CVE:</strong> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-8593" target="_blank">CVE-2020-8593</a></p>

<p><strong>Vendor:</strong> DNN Software (<a href="https://www.dnnsoftware.com/" target="_blank">https://www.dnnsoftware.com/</a>, <a href="https://dnncommunity.org/" target="_blank">https://dnncommunity.org/</a>)</p>

<p><strong>Product:</strong> DotNetNuke, DNN Platform</p>

<p><strong>Version Affected:</strong> &lt;= 9.4.x</p>

<p><strong>Fixed Version:</strong> 9.5.0</p>

<p><strong>Description:</strong></p>

<blockquote>
<p>&ldquo;The DNN Platform is a free and open source product you can download today and create powerful websites with.&rdquo;</p>
</blockquote>

<p>The DNN Platform&rsquo;s administrative panel provides a <code>File Manager</code> component which is vulnerable to directory traversal. Attackers can upload a specially crafted zip file which when extracted, allows navigation outside of the <code>File Manager</code> defined <code>Root</code>.</p>

<p>Malicious administrators could navigate outside of the <code>Root</code>, download sensitive files, upload malware or webshells to the application root in order to achieve remote code execution.</p>

<p>We can upload a <code>poc.zip</code> file which extracts its contents to <code>../../../</code> relative to the <code>Global Assets</code> root folder</p>

<p><img src="/images/2020/02/dnn-zip-uploaded.png" alt="" /></p>

<p>DNN allows us to issue an <code>unzip</code> command and extract it in-place:</p>

<p><img src="/images/2020/02/dnn-unzip-uploaded-file.png" alt="" /></p>

<p>Once extracted, DNN creates a series of <code>..</code> pseudo-folders in the UI which can be used to navigate outside of the root:</p>

<p><img src="/images/2020/02/dnn-pseudo-folder.png" alt="" /></p>

<p>We can then use the <code>..</code> pseudo-folders to navigate to the app root and beyond:</p>

<p><img src="/images/2020/02/dnn-navigate-outside-root.png" alt="" /></p>

<p>Zip files are in the whitelist for uploads in the default installation. <code>File Manager</code> will also not display existing folders outside of the Root until we issue a <code>Sync subfolders</code> command through the UI.</p>

<p>We can generate the <code>poc.zip</code> file used in the attack with the following python script:</p>

<pre><code class="language-python">#!/usr/bin/env python3

import zipfile

# The file to USE inside the zip, before compression
filein = &quot;poc.txt&quot;
print(&quot;[i] FileIn: %s\n&quot; % filein)

# How deep are we going?
depth = &quot;&quot;

# Loop 11 times (00-10)
for i in range(11):
  # The .zip file to use
  zipname = &quot;depth-%02d.zip&quot; % i
  print(&quot;[i] ZipName: %s&quot; % zipname)

  # Get the zip file out ready
  with zipfile.ZipFile(zipname , 'w') as zip:
  	# The file INSIDDE the zip
    filezip = &quot;%s%s&quot; % (depth, filein)
    print(&quot;[i] ZipFile: %s&quot; % filezip)

    # Write the zip file out
    zip.write(filein, filezip)

    # Increase depth for next loop
    depth += &quot;../&quot;

print(&quot;\n[i] Done&quot;)
</code></pre>

<p>Script courtesy of <a href="https://github.com/danielmiessler/SecLists/blob/master/Payloads/Zip-Traversal/make.py" target="_blank">SecLists</a></p>

<h4 id="disclosure-timeline">Disclosure timeline</h4>

<ul>
<li>2019-12-06 - Issue disclosed to DNNSoftware</li>
<li>2019-12-06 - Vendor acknowledges issue and confirms a fix is in progress</li>
<li>2020-02-18 - Issue fixed in version 9.5.0</li>
<li>2019-04-08 - Published</li>
</ul>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/security-research">security research</a></span><span class="tag"><a href="/tags/application-security">application security</a></span><span class="tag"><a href="/tags/disclosure">disclosure</a></span><span class="tag"><a href="/tags/directory-traversal">directory traversal</a></span><span class="tag"><a href="/tags/path-traversal">path traversal</a></span><span class="tag"><a href="/tags/cve">cve</a></span><span class="tag"><a href="/tags/security">security</a></span><span class="tag"><a href="/tags/cve-2020-8593">CVE-2020-8593</a></span>
  				</p>
  			</div>

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="/">Bit Therapy</a></span>
            
            <span>_</span>
            <span> <a href="/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            ...
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
